diff -uNr samba-2.999+3.0.alpha20.orig/source/smbd/mangle_hash2.c samba-2.999+3.0.alpha20/source/smbd/mangle_hash2.c
--- samba-2.999+3.0.alpha20.orig/source/smbd/mangle_hash2.c	2002-09-26 14:38:35.000000000 -0500
+++ samba-2.999+3.0.alpha20/source/smbd/mangle_hash2.c	2002-11-10 19:27:57.000000000 -0600
@@ -147,14 +147,12 @@
 {
 	if (prefix_cache) return True;
 
-	prefix_cache = malloc(sizeof(char *) * MANGLE_CACHE_SIZE);
+	prefix_cache = calloc(MANGLE_CACHE_SIZE, sizeof(char *));
 	if (!prefix_cache) return False;
 
-	prefix_cache_hashes = malloc(sizeof(u32) * MANGLE_CACHE_SIZE);
+	prefix_cache_hashes = calloc(MANGLE_CACHE_SIZE, sizeof(u32));
 	if (!prefix_cache_hashes) return False;
 
-	memset(prefix_cache, 0, sizeof(char *) * MANGLE_CACHE_SIZE);
-	memset(prefix_cache_hashes, 0, sizeof(char *) * MANGLE_CACHE_SIZE);
 	return True;
 }
 
